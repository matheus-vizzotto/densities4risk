}else{
xi <- floor(xi)
xd <- xi - floor(xi)
di <- dyad_int(xi)
if(length(di)>=n){
d <- di[1:n]
}else{
k <- n - length(di)
d <- rep(0,n)
d[1:length(di)] <- di
d[(length(di)+1):n] <- dyadn(xd,k)
}
}
return(d)
}
dyadn_pos <- function(x,n){
if(x<1){
d <- dyadn(x,n)
}else{
xi <- floor(xi)
xd <- xi - floor(xi)
di <- dyad_int(xi)
if(length(di)>=n){
d <- di[1:n]
}else{
k <- n - length(di)
d <- rep(0,n)
d[1:length(di)] <- di
d[(length(di)+1):n] <- dyadn(xd,k)
}
}
return(d)
}
dyadn_pos(12)
dyadn_pos <- function(x,n){
if(x<1){
d <- dyadn(x,n)
}else{
xi <- floor(x)
xd <- x - floor(x)
di <- dyad_int(xi)
if(length(di)>=n){
d <- di[1:n]
}else{
k <- n - length(di)
d <- rep(0,n)
d[1:length(di)] <- di
d[(length(di)+1):n] <- dyadn(xd,k)
}
}
return(d)
}
dyadn_pos(12)
dyadn_pos(12,n)
dyadn_pos(12,5)
dyadn_pos(12,20)
dyadn_pos(53.08,20)
vd <- dyadn_pos(.7852,20)
vd
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
h <- c(.482963,.836516,.224144,-.12941)
N <- length(h)/2
T0 <- matrix(0,2*N-1,2*N-1)
T1 <- matrix(0,2*N-1,2*N-1)
for(i in 1:(2*N-1)){
for(j in 1:(2*N-1)){
# caso seja tomado um índice do filtro fora de {0,...,2N-1}, é
# atribuído um valor zero ao elemento da matriz
h_ind <- ifelse((2*i-j-1<0),0,ifelse((2*i-j-1>2*N-1),0,h[2*i-j]))
T0[i,j] <- sqrt(2)*h_ind
h_ind <- ifelse((2*i-j<0),0,ifelse((2*i-j>2*N-1),0,h[2*i-j+1]))
T1[i,j] <- sqrt(2)*h_ind
}
}
T0
T1
vd <- dyadn_pos(.7852,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
mT # resultado
x <- 0.45
vu <- rep(0,2*N-1)
for(i in 0:(2*N-2)){
# se para algum i o índice i+1-floor(2x) é negativo ou maior que 2N-1,
# então o componente de vu é zero
h_ind <- ifelse((i+1-floor(2*x)<0),0,ifelse((i+1-floor(2*x)>2*N-1),0,h[i+1-floor(2*x)+1]))
vu[i+1] <- ((-1)^(1-floor(2*x)))*h_ind
}
vd2x <- dyadn_pos(2*x,20)
if(vd2x[1]==0) mT2x <- T0 else mT2x <- T1
for(i in 2:length(vd2x)){
if(vd2x[i]==0) mT2x <- mT2x%*%T0 else mT2x <- mT2x%*%T1
}
vxn <- mT2x%*%rep(1,2*N-1)/(2*N-1)
vu%*%vxn
x <- 0.45
vu <- rep(0,2*N-1)
for(i in (-1):(2*N-2)) vu[i+2] <- ((-1)^i)*h[i+2]
x <- 0.45
vu <- rep(0,2*N-1)
for(i in (-1):(2*N-2)) vu[i+2] <- ((-1)^i)*h[i+2]
vd2x <- dyadn_pos(2*x,20)
if(vd2x[1]==0) mT2x <- T0 else mT2x <- T1
for(i in 2:length(vd2x)){
if(vd2x[i]==0) mT2x <- mT2x%*%T0 else mT2x <- mT2x%*%T1
}
vxn <- c(0,mT2x%*%rep(1,2*N-1)/(2*N-1))
sqrt(2)*vu%*%vxn
x <- 1.7852
psi_value = 0
for(i in (-1):(2*N-2)){
if(2*x+i<0||2*x+i>2*N-1){
psi_value = psi_value + 0
}else{
vd <- dyadn_pos(2*x+i,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(j in 2:length(vd)){
if(vd[j]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
psi_value = psi_value + ((-1)^(-i))*h[2+i]*sqrt(2)*mT[1,1]
}
}
psi_value
psi_value
x <- .8315
psi_value = 0
for(i in (-1):(2*N-2)){
if(2*x+i<0||2*x+i>2*N-1){
psi_value = psi_value + 0
}else{
vd <- dyadn_pos(2*x+i,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(j in 2:length(vd)){
if(vd[j]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
psi_value = psi_value + ((-1)^(-i))*h[2+i]*sqrt(2)*mT[1,1]
}
}
psi_value
x <- 0.45
vu <- rep(0,2*N-1)
for(i in (-1):(2*N-2)) vu[i+2] <- ((-1)^i)*h[i+2]
vd2x <- dyadn_pos(2*x,20)
if(vd2x[1]==0) mT2x <- T0 else mT2x <- T1
for(i in 2:length(vd2x)){
if(vd2x[i]==0) mT2x <- mT2x%*%T0 else mT2x <- mT2x%*%T1
}
vxn <- c(0,mT2x%*%rep(1,2*N-1)/(2*N-1))
sqrt(2)*vu%*%vxn
vd <- dyadn_pos(.8315,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
mT # resultado
vd <- dyadn_pos(1.7852,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
mT # resultado
phi.n >- function(x,n,h){
if(x<0 || x>length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>0){
if(y<1){
vd <- dyadn_pos(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n <- function(x,n,h){
if(x<0 || x>length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>0){
if(y<1){
vd <- dyadn_pos(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n(.45,20,h)
phi.n(1.45,20,h)
phi.n(2.45,20,h)
phi.n(3.45,20,h)
phi.n(-.45,20,h)
phi.n(0,20,h)
phi.n <- function(x,n,h){
if(x<0 || x>length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>0){
if(y<1){
vd <- dyadn(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n(0,20,h)
dyadn(0,5)
vd <- dyadn_pos(0,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
mT # resultado
phi.n <- function(x,n,h){
if(x<0 || x>length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>=0){
if(y<1){
vd <- dyadn(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n(0,20,h)
phi.n(1.7852,20,h)
phi.n(2.7389,20,h)
length(h)/2
length(h)
psi.n <- function(x,n,h){
if(x<1-length(h)/2 || x>length(h)/2){
return(0)
}else{
psiv = 0
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*h[2+i]*phi.n(2*x+i)
return(psiv)
}
}
psi.n(.45)
h
psi.n(.45,20,h)
psi.n <- function(x,n,h){
if(x<1-length(h)/2 || x>length(h)/2){
return(0)
}else{
psiv = 0
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*h[2+i]*phi.n(2*x+i,n,h)
return(psiv)
}
}
psi.n(.45,20,h)
phi.n(.45,20,h)
phi.n <- function(x,n,h){
if(x<0 || x>length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>=0){
if(y<1){
vd <- dyadn(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
psi.n <- function(x,n,h){
if(x<1-length(h)/2 || x>length(h)/2){
return(0)
}else{
psiv = 0
ha <- h[length(h):1]
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*ha[2+i]*phi.n(2*x+i,n,h)
return(psiv)
}
}
psi.n(.45,20,h)
phi.n(.45,20,h)
psi.n(.45,20,h)
psi.n <- function(x,n,h){
if(x<1-length(h)/2 || x>length(h)/2){
return(0)
}else{
psiv = 0
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*h[2+i]*phi.n(2*x+i,n,h)
return(psiv)
}
}
phi.n(.45,20,h)
psi.n(.45,20,h)
psi.n(1,20,h)
phi.n(1,20,h)
phi.n(2,20,h)
psi.n(1.1,20,h)
phi.n(1.1,20,h)
psi.n(1.1,20,h)
psi.n(1.5,20,h)
psi.n(1.49,20,h)
psi.n(.95,20,h)
psi.n(.45,20,h)
x <- 0.45
vu <- rep(0,2*N-1)
for(i in 0:(2*N-2)){
# se para algum i o índice i+1-floor(2x) é negativo ou maior que 2N-1,
# então o componente de vu é zero
h_ind <- ifelse((i+1-floor(2*x)<0),0,ifelse((i+1-floor(2*x)>2*N-1),0,h[i+1-floor(2*x)+1]))
vu[i+1] <- ((-1)^(1-floor(2*x)))*h_ind
}
vd2x <- dyadn_pos(2*x,20)
if(vd2x[1]==0) mT2x <- T0 else mT2x <- T1
for(i in 2:length(vd2x)){
if(vd2x[i]==0) mT2x <- mT2x%*%T0 else mT2x <- mT2x%*%T1
}
vxn <- mT2x%*%rep(1,2*N-1)/(2*N-1)
vu%*%vxn
x <- 0.45
vu <- rep(0,2*N-1)
for(i in (-1):(2*N-2)) vu[i+2] <- ((-1)^i)*h[i+2]
vd2x <- dyadn_pos(2*x,20)
if(vd2x[1]==0) mT2x <- T0 else mT2x <- T1
for(i in 2:length(vd2x)){
if(vd2x[i]==0) mT2x <- mT2x%*%T0 else mT2x <- mT2x%*%T1
}
vxn <- c(0,mT2x%*%rep(1,2*N-1)/(2*N-1))
sqrt(2)*vu%*%vxn
sqrt(2)*vu%*%vxn
x <- .45
psi_value = 0
for(i in (-1):(2*N-2)){
if(2*x+i<0||2*x+i>2*N-1){
psi_value = psi_value + 0
}else{
vd <- dyadn_pos(2*x+i,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(j in 2:length(vd)){
if(vd[j]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
psi_value = psi_value + ((-1)^(-i))*h[2+i]*sqrt(2)*mT[1,1]
}
}
psi_value
psi.n(1.5,20,h)
phi.n <- function(x,n,h){
if(x<=0 || x>=length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>=0){
if(y<1){
vd <- dyadn(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n(2.7389,20,h)
psi.n <- function(x,n,h){
if(x<=1-length(h)/2 || x>=length(h)/2){
return(0)
}else{
psiv = 0
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*h[2+i]*phi.n(2*x+i,n,h)
return(psiv)
}
}
psi.n(1.5,20,h)
h <- c(.482963,.836516,.224144,-.12941)
N <- length(h)/2
T0 <- matrix(0,2*N-1,2*N-1)
T1 <- matrix(0,2*N-1,2*N-1)
for(i in 1:(2*N-1)){
for(j in 1:(2*N-1)){
# caso seja tomado um índice do filtro fora de {0,...,2N-1}, é
# atribuído um valor zero ao elemento da matriz
h_ind <- ifelse((2*i-j-1<0),0,ifelse((2*i-j-1>2*N-1),0,h[2*i-j]))
T0[i,j] <- sqrt(2)*h_ind
h_ind <- ifelse((2*i-j<0),0,ifelse((2*i-j>2*N-1),0,h[2*i-j+1]))
T1[i,j] <- sqrt(2)*h_ind
}
}
T0
T1
dyadn <- function(x,n){
d <- rep(0,n)
xd <- x
for(i in 1:n){
d[i] <- floor(2*xd)
xd = 2*xd - floor(2*xd)
}
return(d)
}
dyad_int <- function(x){
d = numeric(0)
xi <- floor(x)
i = 1
d[i] <- xi%%2
while(xi>1){
d[i] <- xi%%2
xi <- xi%/%2
i = i + 1
}
d[i] <- xi
return(d[length(d):1])
}
dyadn_pos <- function(x,n){
if(x<1){
d <- dyadn(x,n)
}else{
xi <- floor(x)
xd <- x - floor(x)
di <- dyad_int(xi)
if(length(di)>=n){
d <- di[1:n]
}else{
k <- n - length(di)
d <- rep(0,n)
d[1:length(di)] <- di
d[(length(di)+1):n] <- dyadn(xd,k)
}
}
return(d)
}
vd <- dyadn_pos(.45,20)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)){
if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
}
mT # resultado
phi.n <- function(x,n,h){
if(x<=0 || x>=length(h)-1){
return(0)
}else{
k <- 1
y <- x
while(y>=0){
if(y<1){
vd <- dyadn(y,n)
if(vd[1]==0) mT <- T0 else mT <- T1
for(i in 2:length(vd)) if(vd[i]==0) mT <- mT%*%T0 else mT <- mT%*%T1
return(mT[k,1])
}else{
y <- y - 1
k <- k + 1
}
}
}
}
phi.n(2.7389,20,h)
psi.n <- function(x,n,h){
if(x<=1-length(h)/2 || x>=length(h)/2){
return(0)
}else{
psiv = 0
for(i in (-1):(length(h)-2)) psiv = psiv +
((-1)^i)*sqrt(2)*h[2+i]*phi.n(2*x+i,n,h)
return(psiv)
}
}
phi.n(.45,20,h)
psi.n(.45,20,h)
phi.n(1,20,h)
phi.n(1.1,20,h)
phi.n(1.0001,20,h)
phi.n(1.0000001,20,h)
