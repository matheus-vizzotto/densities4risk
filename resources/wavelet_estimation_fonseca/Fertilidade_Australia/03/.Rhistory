dim(columb)
dim(columb.polys)
class(columb.polys)
length(columb.polys)
head(columb.polys)
head(columb)
draw.polys(polys, object = NULL, scheme = NULL,
swapcolors = FALSE, n.col = 100, ...)
draw.polys(polys, object = NULL, scheme = NULL,swapcolors = FALSE, n.col = 100)
draw.polys(polys, object = NULL, scheme = NULL,swapcolors = FALSE, n.col = 100,
data=columb)
draw.polys(polys, object = NULL, scheme = NULL,swapcolors = FALSE, n.col = 100,
data=columb.polys)
draw.polys(columb.polys, object = NULL, scheme = NULL,swapcolors = FALSE, n.col = 100)
polys2nb(columb.polys)
nb2prec(neighbour,x,area=NULL)
library(spdep)
library(maptools)
install.packages("spdep")
install.packages("maptools")
library(spdep)
library(maptools)
bh <- readShapePoly(system.file("etc/shapes/bhicv.shp",
package="spdep")[1])
BhData <- data.frame(scale(bh@data[,5:8]))
bh.nb <- poly2nb(bh) # neighbourhood
bh.polys <- bh@polygons # polygons
newpolys <- polys2polys(bh.polys,bh.nb)
newnb <- nb2nb(bh.nb)
draw.polys(newpolys[[1]])
poo <-BhData$HLCI
names(poo) <- row.names(BhData)
draw.polys(newpolys[[1]], poo)
Prec <- nb2prec(newnb, x=as.factor(row.names(BhData)),
area=as.factor(row.names(BhData)))
library(gamlss)
library(mgcv)
data(columb)
data(columb.polys)
vizinhos=polys2nb(columb.polys)
precisionC <- nb2prec(vizinhos,x=columb$district)
m1<- gamlss(crime~ gmrf(district, polys=columb.polys, method="Q"), data=columb)
m2<- gamlss(crime~ gmrf(district, polys=columb.polys, method="A"), data=columb)
AIC(m1,m2, k=0)
draw.polys(columb.polys, getSmo(m2), scheme="topo")
library(mgcv)
data(columb)
data(columb.polys)
vizinhos=polys2nb(columb.polys)
precisionC <- nb2prec(vizinhos,x=columb$district)
m1<-MRFA(columb$crime, columb$district, polys=columb.polys)
m11<-MRFA(columb$crime, columb$district, precision=precisionC)
m12<-MRFA(columb$crime, columb$district, neighbour=vizinhos)
draw.polys(columb.polys, m12, scheme="heat",swapcolors=TRUE)
m2<-MRF(columb$crime, columb$district, polys=columb.polys)
m21<-MRF(columb$crime, columb$district, precision=precisionC)
m22<-MRF(columb$crime, columb$district, neighbour=vizinhos)
AIC(m1, m11,m12,m2, m21, m22, k=0)
draw.polys(columb.polys, m12, scheme="heat",swapcolors=TRUE)
columb2 <- columb[-5,]
precisionC2 <- nb2prec(vizinhos,x=columb$district,area=columb$district)
m11<-MRFA(columb2$crime, columb2$district, polys=columb.polys, area=columb$district)
m112<-MRFA(columb2$crime, columb2$district, polys=columb.polys)
m111<-MRFA(columb2$crime, columb2$district, precision=precisionC,area=columb$district)
m121<-MRFA(columb2$crime, columb2$district, neighbour=vizinhos,area=columb$district)
m113<-MRFA(columb2$crime, columb2$district, precision=precisionC2,area=columb$district)
AIC(m11,m112,m111,m121,m113, k=0)
m11<-MRFA(columb2$crime, columb2$district, polys=columb.polys, area=columb$district)
m112<-MRFA(columb2$crime, columb2$district, polys=columb.polys)
m111<-MRFA(columb2$crime, columb2$district, precision=precisionC,area=columb$district)
m121<-MRFA(columb2$crime, columb2$district, neighbour=vizinhos,area=columb$district)
m113<-MRFA(columb2$crime, columb2$district, precision=precisionC2,area=columb$district)
AIC(m11,m112,m111,m121,m113, k=0)
draw.polys(columb.polys, fitted(m11))
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(mvrnorm(n = 1000, rep(0, 2), Sigma))
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,nclor=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(n)
vV <- L%*%vV
mX[,i] <- vMu + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, rep(0, 2), Sigma))
?matrix
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(n)
vV <- L%*%vV
mX[,i] <- vMu + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, rep(0, 2), Sigma))
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(n)
vV <- mL%*%vV
mX[,i] <- vMu + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, rep(0, 2), Sigma))
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(n)
vV <- mL%*%vZ
mX[,i] <- vMu + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, rep(0, 2), Sigma))
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(n)
vV <- mL%*%as.numeric(vZ)
mX[,i] <- vMu + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, rep(0, 2), Sigma))
vMu=rep(0, 2)
mSig=Sigma
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
mL
i=1
vZ <- rnorm(n)
n = 1000
vZ <- rnorm(p)
vV <- mL%*%as.numeric(vZ)
mX[,i] <- vMu + vV
vV <- mL%*%vZ
vV
vMu
as.numeric(vMu)
as.numeric(vMu) + vV
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=n,nrow=p)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(p)
vV <- mL%*%vZ
mX[,i] <- as.numeric(vMu) + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma))
rnormVar(n = 1, vMu=rep(0, 2), mSig=Sigma)
rnormVar(n = 1, vMu=rep(0, 2), mSig=Sigma)
var(rnormVar(n = 2, vMu=rep(0, 2), mSig=Sigma))
var(t(rnormVar(n = 2, vMu=rep(0, 2), mSig=Sigma)))
var(t(rnormVar(n = 3, vMu=rep(0, 2), mSig=Sigma)))
var(t(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma)))
Sigma
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(t(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma)))
var(t(rnormVar(n = 10000, vMu=rep(0, 2), mSig=Sigma)))
mean(t(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma)))
require(MASS)
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(mvrnorm(n = 1000, rep(0, 2), Sigma))
mvrnorm(n = 1, rep(0, 2), Sigma)
mvrnorm(n = 3, rep(0, 2), Sigma)
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(t(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma)))
rnormVar(n = 1, vMu=rep(0, 2), mSig=Sigma)
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=p,nrow=n)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(p)
vV <- mL%*%vZ
mX[i,] <- as.numeric(vMu) + vV
}
return(mX)
}
var(t(rnormVar(n = 3, vMu=rep(0, 2), mSig=Sigma)))
var(rnormVar(n = 3, vMu=rep(0, 2), mSig=Sigma))
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 3, vMu=rep(0, 2), mSig=Sigma))
var(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma))
p <- length(vMu)
mX <- matrix(0,ncol=p,nrow=n)
mL <- chol(mSig)
chol(mSig)
mSig
mL%*%t(mL)
?chol
t(mL)%*%mL
mL%*%t(mL)
rnormVar <- function(n,vMu,mSig){
p <- length(vMu)
mX <- matrix(0,ncol=p,nrow=n)
mL <- chol(mSig)
for(i in 1:n){
vZ <- rnorm(p)
vV <- t(mL)%*%vZ
mX[i,] <- as.numeric(vMu) + vV
}
return(mX)
}
require(MASS)
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(mvrnorm(n = 3, rep(0, 2), Sigma))
var(mvrnorm(n = 1000, rep(0, 2), Sigma))
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 1000, vMu=rep(0, 2), mSig=Sigma))
var(rnormVar(n = 10000, vMu=rep(0, 2), mSig=Sigma))
rnormPrec <- function(n,vMu,mPrec){
p <- length(vMu)
mX <- matrix(0,ncol=p,nrow=n)
mL <- chol(mPrec)
for(i in 1:n){
vZ <- rnorm(p)
vV <- solve(mL,vZ)
mX[i,] <- as.numeric(vMu) + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormVar(n = 10000, vMu=rep(0, 2), mSig=Sigma))
var(rnormPrec(n = 10000, vMu=rep(0, 2), mSig=Sigma))
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormPrec(n = 10000, rep(0, 2), Sigma))
solve(Sigma)
solve(var(rnormPrec(n = 10000, rep(0, 2), Sigma)))
var(rnormPrec(n = 10000, rep(0, 2), Sigma))
Sigma
var(rnormPrec(n = 10000, rep(0, 2), solve(Sigma)))
rnormCanon <- function(n,vB,mPrec){
p <- length(vMu)
mX <- matrix(0,ncol=p,nrow=n)
mL <- chol(mPrec)
vW <- solve(t(mL), vB)
vMu <- solve(mL, vW)
for(i in 1:n){
vZ <- rnorm(p)
vV <- solve(mL,vZ)
mX[i,] <- as.numeric(vMu) + vV
}
return(mX)
}
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormCanon(n = 10000, rep(0, 2), solve(Sigma)))
apply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),mean,2)
lapply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),mean,2)
sapply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),mean,2)
sapply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),mean,1)
apply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),mean,1)
?apply
?apply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),1,mean)
apply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),1,mean)
apply(rnormCanon(n = 5, rep(0, 2), solve(Sigma)),2,mean)
apply(rnormCanon(n = 1000, rep(0, 2), solve(Sigma)),2,mean)
apply(rnormCanon(n = 1000, rep(0, 2), solve(Sigma)),2,mean)
solve(Sigma)%*%c(1,3)
var(rnormCanon(n = 10000, c(1,3), solve(Sigma)))
apply(rnormCanon(n = 1000, c(1,3), solve(Sigma)),2,mean)
solve(Sigma)%*%c(1,3)
Sigma <- matrix(c(10,3,3,2),2,2)
Sigma
var(rnormCanon(n = 10000, c(1,3), solve(Sigma)))
solve(Sigma)%*%c(1,3)
apply(rnormCanon(n = 1000, c(1,3), Sigma),2,mean)
data("drivers")
head(drivers)
plot(drivers)
length(drivers)
mQy <- matrix(0,10,10)
for(i in 1:7){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy
mQy <- matrix(0,10,10)
for(i in (-2):10){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy <- matrix(0,14,14)
for(i in 1:11){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy
mQy[4:14,1:10]
mQy[1:10,4:14]
mQy[1:10,4:13]
mQy[1:10,1:10]
mQy <- matrix(0,10,10)
for(i in 1:7){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy
mQy <- matrix(0,7,10)
for(i in 1:7){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy[1:10,1:10]
mQy
mQy%*%t(mQy)
mQy <- matrix(0,7,10)
mQy
for(i in 1:7){
mQy[i,i:(i+3)] <- rep(1,4)
}
mQy%*%t(mQy)
mQy
t(mQy)%*%mQy
mQy%*%t(mQy)
solve(mQy%*%t(mQy))
round(solve(mQy%*%t(mQy)),4)
t(mQy)%*%mQy
mD <- matrix(0,7,10)
for(i in 1:7){
mD[i,i:(i+3)] <- rep(1,4)
}
mQy <- t(mD)%*%mD
mQy
m <- 4
n <- 10
mD <- matrix(0,n-m+1,n)
for(i in 1:7){
mD[i,i:(i+3)] <- rep(1,m)
}
mQy <- t(mD)%*%mD
mQy
length(drivers)
n <- length(drivers)
m <- 12
for(i in 1:(n-m+1)){
mD[i,i:(i+m-1)] <- rep(1,m)
}
n=10
m=4
mD <- matrix(0,n-m+1,n)
for(i in 1:(n-m+1)){
mD[i,i:(i+m-1)] <- rep(1,m)
}
mD
n <- length(drivers)
m <- 12
mD <- matrix(0,n-m+1,n)
i=1
mD[i,i:(i+m-1)] <- rep(1,m)
for(i in 1:(n-m+1)){
mD[i,i:(i+m-1)] <- rep(1,m)
}
n <- length(drivers)
m <- 12
mD <- matrix(0,n-m+1,n)
for(i in 1:(n-m+1)){
mD[i,i:(i+m-1)] <- rep(1,m)
}
mD[1:15,1:15]
mD[171:181,190:192]
mD[171:181,180:192]
mQy <- t(mD)%*%mD
mQy[180:192,180:192]
mQy[1:20,1:20]
mQss <- t(mD)%*%mD
n=10
mD <- matrix(0,n-2,n)
for(i in 1:(n-2)){
mD[i,i:(i+2)] <- c(1,-2,1)
}
mD
t(mD)%*%mD
n <- length(drivers)
mD <- matrix(0,n-2,n)
for(i in 1:(n-2)){
mD[i,i:(i+2)] <- c(1,-2,1)
}
mQtt <- t(mD)%*%mD
mQtt[1:10,1:10]
vY <- drivers
var(vY)
1/var(vY)
1/0.0005
kappY <- 1
kappS <- 1/0.0005
kappT <- 1/0.1
diag(5)
dim(mQss)
n
mSig <- rbind(cbind(mQss, kappY*diag(n)), cbind(kappY*diag(n), mQtt))
vMu <- (-1)*rbind(-kappY*diag(n),-kappY*diag(n))%*%vY
mSig <- rbind(cbind(kappS*mQss, kappY*diag(n)), cbind(kappY*diag(n), kappT*mQtt))
vMu <- (-1)*rbind(-kappY*diag(n),-kappY*diag(n))%*%vY
mean(rgamma(10000,5,3))
5/3
if(nchar(system.file(package="stabledist"))) citation("stabledist")
if(nchar(system.file(package="FMStable"))) citation("FMStable")
apple_data = read.table("apple_river.txt",header = FALSE)
vyears_apple = as.numeric(substr(as.character(apple_data[,3]),1,4))
apple_data = read.table("apple_river.txt",header = FALSE)
install.packages("ftsa")
setwd("~/Documentos/Aplicacao")
result = T_stationary(sample = pm_10_GR_sqrt$y)
require(ftsa)
result = T_stationary(sample = pm_10_GR_sqrt$y)
dim(pm_10_GR_sqrt)
class(pm_10_GR_sqrt)
class(pm_10_GR_sqrt$y)
size(pm_10_GR_sqrt$y)
dim(pm_10_GR_sqrt$y)
plot(1:48,pm_10_GR_sqrt$y[,1],type='l')
help("pm_10_GR_sqrt")
result_pivotal = T_stationary(sample = pm_10_GR_sqrt$y, J = 100, MC_rep = 5000,
h = 20, pivotal = TRUE)
dim(SmoLogFertRate)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
dim(SmoLogFertRate)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100, MC_rep = 5000,
h = 20, pivotal = TRUE)
result_pivotal = T_stationary(sample = SmoLogFertRate)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
dim(SmoLogFertRate)
require(ftsa)
help("T_stationary")
n = dim(SmoLogFertRate)[2]
sqrt(n)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100, MC_rep = 1000,
h = sqrt(n), pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100, MC_rep = 5000,
h = sqrt(n), pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
sqrt(n)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100, MC_rep = 5000,
10, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100, MC_rep = 5000,
9, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
dim(SmoLogFertRate)
aux = seq(1,999,length=64)
aux = round(seq(1,999,length=64))
result_pivotal = T_stationary(sample = SmoLogFertRate[aux,], J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=FALSE,
Ker2=TRUE)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
n = dim(SmoLogFertRate)[2]
require(ftsa)
help("T_stationary")
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
n = dim(SmoLogFertRate)[2]
require(ftsa)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
n = dim(SmoLogFertRate)[2]
n
dim(SmoLogFertRate)
require(ftsa)
result_pivotal = T_stationary(sample = SmoLogFertRate, J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
SmoLogFertRate = read.csv('SmoLogFertRate.csv')
n = dim(SmoLogFertRate)[2]
999/7
999-150
require(ftsa)
result_pivotal = T_stationary(sample = SmoLogFertRate[1:849,], J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
result_pivotal = T_stationary(sample = SmoLogFertRate[1:800,], J = 100,
MC_rep = 1000, pivotal = TRUE, Ker1=TRUE,
Ker2=FALSE)
